<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <link rel="stylesheet" href="new_home.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <body>
    <div class="video-background">
      <video src="img/bg_video.mp4" autoplay muted loop></video>
    </div>

    <div class="overlay">
      <nav class="navbar">
        <div class="navbar-container">
          <ul class="navbar-list">
            <li class="navbar-item">
              <a href="http://127.0.0.1:8000/dashboard/">Profile</a>
            </li>
            <li class="navbar-item"><a href="/about">About Us</a></li>
            <li class="navbar-item"><a href="/contactus">Contact Us</a></li>
            <li class="navbar-item"><a href="/news">News</a></li>
          </ul>
        </div>
      </nav>

      <div class="carousel-container">
        <div class="carousel">
            <div class="carousel-images">
                <div class="carousel-item active">
                    <img src="https://static.timesofisrael.com/www/uploads/2023/03/33AN3EN-highres-1024x640.jpg" alt="Earthquake">
                    <div class="caption">
                        <h5>Earthquake</h5>
                        <p><a href="#" class="btn">Learn More</a></p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="https://cbsnews1.cbsistatic.com/hub/i/r/2018/08/19/3c6c4bb8-cb45-4e0e-bdbb-28d39d1470d4/thumbnail/1240x834/5d187ee49c6b73f781cedba817130848/ap-18230455383876.jpg" alt="Flood">
                    <div class="caption">
                        <h5>Flood</h5>
                        <p><a href="#" class="btn">Learn More</a></p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="https://cdn.devastatingdisasters.com/wp-content/uploads/2021/08/1-fires.jpg" alt="Fire">
                    <div class="caption">
                        <h5>Fire</h5>
                        <p><a href="#" class="btn">Learn More</a></p>
                    </div>
                </div>
            </div>
            <button class="prev" onclick="moveSlide(-1)">&#10094;</button>
            <button class="next" onclick="moveSlide(1)">&#10095;</button>
        </div>
    </div>

    <script>
        let currentIndex = 0;

        function showSlide(index) {
            const items = document.querySelectorAll('.carousel-item');
            items.forEach((item, i) => {
                item.style.display = i === index ? 'block' : 'none';
            });
        }

        function moveSlide(direction) {
            const items = document.querySelectorAll('.carousel-item');
            currentIndex = (currentIndex + direction + items.length) % items.length;
            showSlide(currentIndex);
        }

        // Show the first slide initially
        showSlide(currentIndex);
    </script>

<div>
    <section id="coordinates">
        <h1>Your Coordinates</h1>
        <p id="lat-long">Latitude: Not available, Longitude: Not available</p>
        <p id="city-state">City: Not available, State: Not available</p>
    </section>

    <section id="location-section">
        <div id="map"></div>
    </section>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    let map, marker;
    let latitude, longitude, city, state;

    // Get user's location
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showMap, showError);
    } else {
        alert("Geolocation is not supported by this browser.");
    }

    // Show map and location data
    function showMap(position) {
        latitude = position.coords.latitude;
        longitude = position.coords.longitude;

        // Initialize map
        map = L.map("map").setView([latitude, longitude], 13);
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            maxZoom: 18,
            attribution: "Â© OpenStreetMap"
        }).addTo(map);

        // Add marker
        marker = L.marker([latitude, longitude]).addTo(map);
        marker.bindPopup("<b>Your Location</b><br>Lat: " + latitude + "<br>Lon: " + longitude).openPopup();

        // Get city and state
        getCityState(latitude, longitude);
    }

    // Function to get city and state based on coordinates
    function getCityState(lat, lng) {
        const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=10&addressdetails=1`;

        $.getJSON(url, function (data) {
            city = data.address.city || data.address.town || data.address.village || "Unknown City";
            state = data.address.state || "Unknown State";
            document.getElementById("lat-long").innerHTML = `Latitude: ${latitude}, Longitude: ${longitude}`;
            document.getElementById("city-state").innerHTML = `City: ${city}, State: ${state}`;
        }).fail(function () {
            document.getElementById("lat-long").innerHTML = "Unable to retrieve coordinates.";
            document.getElementById("city-state").innerHTML = "Unable to retrieve city/state.";
        });
    }

    // Error handler for geolocation
    function showError(error) {
        switch (error.code) {
            case error.PERMISSION_DENIED:
                alert("User denied the request for Geolocation.");
                break;
            case error.POSITION_UNAVAILABLE:
                alert("Location information is unavailable.");
                break;
            case error.TIMEOUT:
                alert("The request to get user location timed out.");
                break;
            default:
                alert("An unknown error occurred.");
        }
    }
</script>

<div class="flex-container">
    <a href="/calamityresult">
        <button class="panic-button">PANIC Button</button>
    </a>
</div>

    </div>
  </body>
</html>
